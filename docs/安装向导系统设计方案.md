# è·¨å¹³å°Webå®‰è£…å‘å¯¼ç³»ç»Ÿè®¾è®¡æ–¹æ¡ˆ

## ğŸ“‹ ç›®å½•

- [æ¦‚è¿°](#æ¦‚è¿°)
- [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
- [å®‰è£…æµç¨‹è®¾è®¡](#å®‰è£…æµç¨‹è®¾è®¡)
- [æ ¸å¿ƒæ¨¡å—è®¾è®¡](#æ ¸å¿ƒæ¨¡å—è®¾è®¡)
- [ç”¨æˆ·ç•Œé¢è®¾è®¡](#ç”¨æˆ·ç•Œé¢è®¾è®¡)
- [å¹³å°å…¼å®¹æ€§](#å¹³å°å…¼å®¹æ€§)
- [å®ç°æ–¹æ¡ˆ](#å®ç°æ–¹æ¡ˆ)
- [éƒ¨ç½²ç­–ç•¥](#éƒ¨ç½²ç­–ç•¥)

---

## ğŸ¯ æ¦‚è¿°

### è®¾è®¡ç›®æ ‡

æ„å»ºä¸€ä¸ªè·¨å¹³å°çš„Webå®‰è£…å‘å¯¼ï¼Œèƒ½å¤Ÿï¼š
- ğŸŒ **è·¨å¹³å°æ”¯æŒ**ï¼šLinuxã€Windowsã€macOS
- ğŸ” **æ™ºèƒ½æ£€æµ‹**ï¼šè‡ªåŠ¨æ£€æµ‹ç³»ç»Ÿç¯å¢ƒå’Œä¾èµ–
- ğŸ“¦ **è‡ªåŠ¨å®‰è£…**ï¼šè‡ªåŠ¨ä¸‹è½½å’Œå®‰è£…ç¼ºå¤±çš„ä¾èµ–
- ğŸ¨ **å‹å¥½ç•Œé¢**ï¼šæä¾›ç›´è§‚çš„Webç•Œé¢æŒ‡å¯¼
- âš¡ **ä¸€é”®éƒ¨ç½²**ï¼šç®€åŒ–æ•´ä¸ªå®‰è£…è¿‡ç¨‹

### æ ¸å¿ƒåŠŸèƒ½

- âœ… ç³»ç»Ÿç¯å¢ƒæ£€æµ‹ï¼ˆOSã€æ¶æ„ã€æƒé™ï¼‰
- âœ… ä¾èµ–è½¯ä»¶æ£€æµ‹å’Œå®‰è£…ï¼ˆNode.jsã€Goã€æ•°æ®åº“ï¼‰
- âœ… æ•°æ®åº“é…ç½®å’Œåˆå§‹åŒ–ï¼ˆMySQLã€MongoDBï¼‰
- âœ… é¡¹ç›®æ–‡ä»¶éƒ¨ç½²å’Œé…ç½®
- âœ… æœåŠ¡å¯åŠ¨å’ŒéªŒè¯
- âœ… å®‰è£…åé…ç½®å’Œä¼˜åŒ–

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   å®‰è£…å‘å¯¼ç¨‹åº                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Webç•Œé¢    â”‚  â”‚  Goåç«¯     â”‚  â”‚  ç³»ç»Ÿè°ƒç”¨   â”‚      â”‚
â”‚  â”‚             â”‚  â”‚             â”‚  â”‚             â”‚      â”‚
â”‚  â”‚ Vue.js      â”‚â—„â”€â”¤HTTP Server  â”‚â—„â”€â”¤System Utils â”‚      â”‚
â”‚  â”‚ Element Plusâ”‚  â”‚Gin Frameworkâ”‚  â”‚Package Mgr  â”‚      â”‚
â”‚  â”‚ åµŒå…¥å¼èµ„æº  â”‚  â”‚Installation â”‚  â”‚File Ops     â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆé€‰æ‹©

#### åç«¯æ ¸å¿ƒ
- **Go 1.21+**ï¼šè·¨å¹³å°ç¼–è¯‘ã€é«˜æ€§èƒ½ã€ä¸°å¯Œçš„ç³»ç»ŸAPI
- **Gin Framework**ï¼šè½»é‡çº§HTTPæœåŠ¡å™¨
- **embed**ï¼šåµŒå…¥é™æ€èµ„æº

#### å‰ç«¯ç•Œé¢
- **Vue 3**ï¼šå“åº”å¼ç”¨æˆ·ç•Œé¢
- **Element Plus**ï¼šUIç»„ä»¶åº“
- **Vite**ï¼šå‰ç«¯æ„å»ºå·¥å…·

#### ç³»ç»Ÿé›†æˆ
- **Package Managers**ï¼šå„å¹³å°åŒ…ç®¡ç†å™¨é›†æˆ
- **Database Drivers**ï¼šMySQLã€MongoDBè¿æ¥å™¨
- **System APIs**ï¼šæ–‡ä»¶ç³»ç»Ÿã€è¿›ç¨‹ç®¡ç†ã€ç½‘ç»œæ£€æµ‹

---

## ğŸ”„ å®‰è£…æµç¨‹è®¾è®¡

### ä¸»è¦å®‰è£…æ­¥éª¤

```mermaid
graph TD
    A[å¯åŠ¨å®‰è£…ç¨‹åº] --> B[ç³»ç»Ÿç¯å¢ƒæ£€æµ‹]
    B --> C[æ˜¾ç¤ºæ¬¢è¿ç•Œé¢]
    C --> D[ç¯å¢ƒæ£€æŸ¥æŠ¥å‘Š]
    D --> E{éœ€è¦å®‰è£…ä¾èµ–?}
    E -->|æ˜¯| F[ä¾èµ–å®‰è£…é€‰æ‹©]
    E -->|å¦| G[æ•°æ®åº“é…ç½®]
    F --> H[è‡ªåŠ¨å®‰è£…ä¾èµ–]
    H --> I[éªŒè¯å®‰è£…ç»“æœ]
    I --> G[æ•°æ®åº“é…ç½®]
    G --> J[é¡¹ç›®é…ç½®]
    J --> K[æ–‡ä»¶éƒ¨ç½²]
    K --> L[æœåŠ¡å¯åŠ¨]
    L --> M[å®‰è£…éªŒè¯]
    M --> N[å®Œæˆå®‰è£…]
```

### è¯¦ç»†æµç¨‹è¯´æ˜

#### 1. é¢„æ£€æŸ¥é˜¶æ®µ (Pre-Check)
```
æ£€æµ‹é¡¹ç›®ï¼š
â”œâ”€â”€ æ“ä½œç³»ç»Ÿç±»å‹å’Œç‰ˆæœ¬
â”œâ”€â”€ ç³»ç»Ÿæ¶æ„ (x64, arm64)
â”œâ”€â”€ å¯ç”¨ç£ç›˜ç©ºé—´
â”œâ”€â”€ ç½‘ç»œè¿æ¥çŠ¶æ€
â”œâ”€â”€ ç®¡ç†å‘˜æƒé™
â””â”€â”€ ç«¯å£å ç”¨æƒ…å†µ (8080, 3306, 27017)
```

#### 2. ä¾èµ–æ£€æµ‹é˜¶æ®µ (Dependencies)
```
å¿…éœ€ä¾èµ–ï¼š
â”œâ”€â”€ Node.js (>= 18.0)
â”œâ”€â”€ npm/yarn
â”œâ”€â”€ Go (>= 1.21)
â”œâ”€â”€ Git
â””â”€â”€ æ•°æ®åº“æœåŠ¡
    â”œâ”€â”€ MySQL (>= 8.0)
    â””â”€â”€ MongoDB (>= 6.0)
```

#### 3. è‡ªåŠ¨å®‰è£…é˜¶æ®µ (Auto-Install)
```
å®‰è£…ç­–ç•¥ï¼š
â”œâ”€â”€ Windows: Chocolatey/Scoop/ç›´æ¥ä¸‹è½½
â”œâ”€â”€ macOS: Homebrew/ç›´æ¥ä¸‹è½½
â”œâ”€â”€ Linux: apt/yum/dnf/snap/ç›´æ¥ä¸‹è½½
â””â”€â”€ å¤‡ç”¨æ–¹æ¡ˆ: å®˜æ–¹ä¸‹è½½æº
```

#### 4. é…ç½®é˜¶æ®µ (Configuration)
```
é…ç½®é¡¹ç›®ï¼š
â”œâ”€â”€ æ•°æ®åº“è¿æ¥é…ç½®
â”œâ”€â”€ åº”ç”¨ç«¯å£é…ç½®
â”œâ”€â”€ å®‰å…¨å¯†é’¥ç”Ÿæˆ
â”œâ”€â”€ ç¯å¢ƒå˜é‡è®¾ç½®
â””â”€â”€ æœåŠ¡é…ç½®æ–‡ä»¶
```

---

## ğŸ§© æ ¸å¿ƒæ¨¡å—è®¾è®¡

### 1. ç³»ç»Ÿæ£€æµ‹æ¨¡å—

```go
package detector

type SystemInfo struct {
    OS           string `json:"os"`
    Arch         string `json:"arch"`
    Version      string `json:"version"`
    FreeSpace    int64  `json:"free_space"`
    HasAdminPerm bool   `json:"has_admin_perm"`
    NetworkOK    bool   `json:"network_ok"`
}

type DependencyStatus struct {
    Name      string `json:"name"`
    Required  string `json:"required"`
    Current   string `json:"current"`
    Installed bool   `json:"installed"`
    Available bool   `json:"available"`
}

type Detector interface {
    DetectSystem() (*SystemInfo, error)
    CheckDependencies() ([]DependencyStatus, error)
    CheckPorts(ports []int) map[int]bool
}
```

### 2. åŒ…ç®¡ç†æ¨¡å—

```go
package installer

type PackageManager interface {
    Install(pkg string) error
    IsInstalled(pkg string) bool
    GetVersion(pkg string) string
    Update(pkg string) error
}

type WindowsPackageManager struct {
    UseChocolatey bool
    UseScoop      bool
}

type MacOSPackageManager struct {
    UseHomebrew bool
}

type LinuxPackageManager struct {
    PackageManager string // apt, yum, dnf, etc.
}
```

### 3. æ•°æ®åº“é…ç½®æ¨¡å—

```go
package database

type DatabaseConfig struct {
    Type     string `json:"type"`
    Host     string `json:"host"`
    Port     int    `json:"port"`
    Username string `json:"username"`
    Password string `json:"password"`
    Database string `json:"database"`
}

type DatabaseManager interface {
    TestConnection(config DatabaseConfig) error
    CreateDatabase(config DatabaseConfig) error
    InitializeTables(config DatabaseConfig) error
    CreateUser(config DatabaseConfig) error
}
```

### 4. é¡¹ç›®éƒ¨ç½²æ¨¡å—

```go
package deployer

type DeploymentConfig struct {
    ProjectPath   string `json:"project_path"`
    ServicePort   int    `json:"service_port"`
    DatabaseURL   string `json:"database_url"`
    SecretKey     string `json:"secret_key"`
    LogLevel      string `json:"log_level"`
}

type Deployer interface {
    ExtractFiles(targetPath string) error
    GenerateConfig(config DeploymentConfig) error
    BuildProject() error
    StartServices() error
    VerifyInstallation() error
}
```

---

## ğŸ¨ ç”¨æˆ·ç•Œé¢è®¾è®¡

### ä¸»è¦ç•Œé¢å¸ƒå±€

#### 1. æ¬¢è¿é¡µé¢
```vue
<template>
  <div class="welcome-page">
    <div class="hero-section">
      <h1>æ’ä»¶ç³»ç»Ÿå®‰è£…å‘å¯¼</h1>
      <p>æ¬¢è¿ä½¿ç”¨è·¨å¹³å°æ’ä»¶ç³»ç»Ÿå®‰è£…ç¨‹åº</p>
      <el-button type="primary" size="large" @click="startInstall">
        å¼€å§‹å®‰è£…
      </el-button>
    </div>
    
    <div class="system-info">
      <el-descriptions title="ç³»ç»Ÿä¿¡æ¯" :column="2">
        <el-descriptions-item label="æ“ä½œç³»ç»Ÿ">{{ systemInfo.os }}</el-descriptions-item>
        <el-descriptions-item label="æ¶æ„">{{ systemInfo.arch }}</el-descriptions-item>
        <el-descriptions-item label="å¯ç”¨ç©ºé—´">{{ systemInfo.freeSpace }}</el-descriptions-item>
      </el-descriptions>
    </div>
  </div>
</template>
```

#### 2. ä¾èµ–æ£€æŸ¥é¡µé¢
```vue
<template>
  <div class="dependency-check">
    <h2>ç¯å¢ƒä¾èµ–æ£€æŸ¥</h2>
    
    <el-table :data="dependencies" style="width: 100%">
      <el-table-column prop="name" label="ä¾èµ–åç§°" width="200">
        <template #default="scope">
          <el-icon><Box /></el-icon>
          {{ scope.row.name }}
        </template>
      </el-table-column>
      
      <el-table-column prop="required" label="è¦æ±‚ç‰ˆæœ¬" width="120" />
      
      <el-table-column prop="current" label="å½“å‰ç‰ˆæœ¬" width="120">
        <template #default="scope">
          <span v-if="scope.row.installed">{{ scope.row.current }}</span>
          <el-tag v-else type="danger" size="small">æœªå®‰è£…</el-tag>
        </template>
      </el-table-column>
      
      <el-table-column prop="status" label="çŠ¶æ€" width="100">
        <template #default="scope">
          <el-tag 
            :type="getStatusType(scope.row)" 
            size="small"
          >
            {{ getStatusText(scope.row) }}
          </el-tag>
        </template>
      </el-table-column>
      
      <el-table-column label="æ“ä½œ" width="120">
        <template #default="scope">
          <el-button 
            v-if="!scope.row.installed && scope.row.available"
            size="small" 
            type="primary"
            @click="installDependency(scope.row)"
          >
            å®‰è£…
          </el-button>
        </template>
      </el-table-column>
    </el-table>
    
    <div class="actions">
      <el-button @click="checkAgain">é‡æ–°æ£€æŸ¥</el-button>
      <el-button 
        type="primary" 
        :disabled="!allDependenciesSatisfied"
        @click="nextStep"
      >
        ä¸‹ä¸€æ­¥
      </el-button>
    </div>
  </div>
</template>
```

#### 3. æ•°æ®åº“é…ç½®é¡µé¢
```vue
<template>
  <div class="database-config">
    <h2>æ•°æ®åº“é…ç½®</h2>
    
    <el-tabs v-model="activeTab">
      <el-tab-pane label="MySQLé…ç½®" name="mysql">
        <DatabaseConfigForm 
          :config="mysqlConfig"
          :type="'mysql'"
          @test="testConnection"
          @save="saveDatabaseConfig"
        />
      </el-tab-pane>
      
      <el-tab-pane label="MongoDBé…ç½®" name="mongodb">
        <DatabaseConfigForm 
          :config="mongoConfig"
          :type="'mongodb'"
          @test="testConnection"
          @save="saveDatabaseConfig"
        />
      </el-tab-pane>
    </el-tabs>
    
    <div class="connection-status">
      <el-alert
        v-if="connectionStatus.mysql"
        title="MySQLè¿æ¥æˆåŠŸ"
        type="success"
        :closable="false"
      />
      <el-alert
        v-if="connectionStatus.mongodb"
        title="MongoDBè¿æ¥æˆåŠŸ"
        type="success"
        :closable="false"
      />
    </div>
  </div>
</template>
```

#### 4. å®‰è£…è¿›åº¦é¡µé¢
```vue
<template>
  <div class="installation-progress">
    <h2>æ­£åœ¨å®‰è£…...</h2>
    
    <el-steps :active="currentStep" finish-status="success">
      <el-step title="å‡†å¤‡ç¯å¢ƒ" />
      <el-step title="å®‰è£…ä¾èµ–" />
      <el-step title="é…ç½®æ•°æ®åº“" />
      <el-step title="éƒ¨ç½²é¡¹ç›®" />
      <el-step title="å¯åŠ¨æœåŠ¡" />
      <el-step title="éªŒè¯å®‰è£…" />
    </el-steps>
    
    <div class="progress-details">
      <h3>{{ currentStepTitle }}</h3>
      <el-progress 
        :percentage="progress" 
        :status="progressStatus"
        stroke-width="8"
      />
      
      <div class="log-output">
        <el-scrollbar height="300px">
          <div 
            v-for="(log, index) in installLogs" 
            :key="index"
            :class="['log-item', log.level]"
          >
            <span class="timestamp">{{ log.timestamp }}</span>
            <span class="message">{{ log.message }}</span>
          </div>
        </el-scrollbar>
      </div>
    </div>
    
    <div class="actions">
      <el-button v-if="installError" @click="retryInstall">é‡è¯•</el-button>
      <el-button v-if="installComplete" type="primary" @click="finishInstall">
        å®Œæˆå®‰è£…
      </el-button>
    </div>
  </div>
</template>
```

### å“åº”å¼è®¾è®¡

```scss
// é€‚é…ä¸åŒå±å¹•å°ºå¯¸
.installer-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
  
  @media (max-width: 768px) {
    padding: 10px;
    
    .el-steps {
      .el-step__title {
        font-size: 14px;
      }
    }
  }
  
  @media (max-width: 480px) {
    .el-table {
      font-size: 12px;
    }
    
    .el-button {
      padding: 8px 15px;
    }
  }
}
```

---

## ğŸ”§ å¹³å°å…¼å®¹æ€§

### Windowså¹³å°

#### åŒ…ç®¡ç†å™¨ä¼˜å…ˆçº§
1. **Chocolatey** (æ¨è)
   ```powershell
   # æ£€æµ‹å’Œå®‰è£…Chocolatey
   if (!(Get-Command choco -ErrorAction SilentlyContinue)) {
       Set-ExecutionPolicy Bypass -Scope Process -Force
       [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072
       iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))
   }
   
   # å®‰è£…Node.js
   choco install nodejs -y
   ```

2. **Scoop** (å¤‡é€‰)
   ```powershell
   # å®‰è£…Scoop
   Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
   irm get.scoop.sh | iex
   
   # å®‰è£…ä¾èµ–
   scoop install nodejs
   ```

3. **ç›´æ¥ä¸‹è½½** (æœ€åé€‰æ‹©)
   ```go
   func downloadAndInstallNodeJS() error {
       url := "https://nodejs.org/dist/v20.10.0/node-v20.10.0-x64.msi"
       return downloadAndExecute(url, "/quiet")
   }
   ```

### macOSå¹³å°

#### Homebrewé›†æˆ
```bash
# æ£€æµ‹å’Œå®‰è£…Homebrew
if ! command -v brew &> /dev/null; then
    /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
fi

# å®‰è£…ä¾èµ–
brew install node
brew install go
brew install mysql
brew install mongodb-community
```

### Linuxå¹³å°

#### å¤šå‘è¡Œç‰ˆæ”¯æŒ
```go
func detectLinuxDistro() string {
    // æ£€æµ‹å‘è¡Œç‰ˆ
    if fileExists("/etc/debian_version") {
        return "debian"
    } else if fileExists("/etc/redhat-release") {
        return "redhat"
    } else if fileExists("/etc/arch-release") {
        return "arch"
    }
    return "unknown"
}

func installOnLinux(pkg string) error {
    distro := detectLinuxDistro()
    
    switch distro {
    case "debian":
        return exec.Command("apt", "update").Run()
        return exec.Command("apt", "install", "-y", pkg).Run()
    case "redhat":
        return exec.Command("yum", "install", "-y", pkg).Run()
    case "arch":
        return exec.Command("pacman", "-S", "--noconfirm", pkg).Run()
    }
    
    return errors.New("unsupported distribution")
}
```

---

## ğŸ’» å®ç°æ–¹æ¡ˆ

### é¡¹ç›®ç»“æ„

```
installer/
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ installer/
â”‚       â””â”€â”€ main.go              # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ detector/                # ç³»ç»Ÿæ£€æµ‹
â”‚   â”‚   â”œâ”€â”€ system.go
â”‚   â”‚   â”œâ”€â”€ dependencies.go
â”‚   â”‚   â””â”€â”€ ports.go
â”‚   â”œâ”€â”€ installer/               # å®‰è£…å™¨
â”‚   â”‚   â”œâ”€â”€ interface.go
â”‚   â”‚   â”œâ”€â”€ windows.go
â”‚   â”‚   â”œâ”€â”€ macos.go
â”‚   â”‚   â””â”€â”€ linux.go
â”‚   â”œâ”€â”€ database/                # æ•°æ®åº“é…ç½®
â”‚   â”‚   â”œâ”€â”€ mysql.go
â”‚   â”‚   â””â”€â”€ mongodb.go
â”‚   â”œâ”€â”€ deployer/                # é¡¹ç›®éƒ¨ç½²
â”‚   â”‚   â”œâ”€â”€ files.go
â”‚   â”‚   â”œâ”€â”€ config.go
â”‚   â”‚   â””â”€â”€ services.go
â”‚   â””â”€â”€ server/                  # HTTPæœåŠ¡å™¨
â”‚       â”œâ”€â”€ handlers.go
â”‚       â”œâ”€â”€ middleware.go
â”‚       â””â”€â”€ routes.go
â”œâ”€â”€ web/                         # å‰ç«¯ç•Œé¢
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ views/
â”‚   â”‚   â”‚   â”œâ”€â”€ Welcome.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ Dependencies.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ Database.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ Installation.vue
â”‚   â”‚   â”‚   â””â”€â”€ Complete.vue
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ SystemInfo.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ DependencyList.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ DatabaseForm.vue
â”‚   â”‚   â”‚   â””â”€â”€ ProgressLog.vue
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â””â”€â”€ installer.ts
â”‚   â”‚   â””â”€â”€ main.ts
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ vite.config.ts
â”œâ”€â”€ assets/                      # é™æ€èµ„æº
â”‚   â”œâ”€â”€ project-files.tar.gz     # é¡¹ç›®æ–‡ä»¶åŒ…
â”‚   â”œâ”€â”€ database-schemas/        # æ•°æ®åº“Schema
â”‚   â””â”€â”€ config-templates/        # é…ç½®æ¨¡æ¿
â”œâ”€â”€ scripts/                     # æ„å»ºè„šæœ¬
â”‚   â”œâ”€â”€ build.sh
â”‚   â”œâ”€â”€ package.sh
â”‚   â””â”€â”€ release.sh
â”œâ”€â”€ go.mod
â”œâ”€â”€ go.sum
â””â”€â”€ README.md
```

### æ ¸å¿ƒä»£ç å®ç°

#### 1. ä¸»ç¨‹åºå…¥å£

```go
// cmd/installer/main.go
package main

import (
    "context"
    "embed"
    "flag"
    "fmt"
    "log"
    "net/http"
    "os"
    "os/signal"
    "syscall"
    "time"

    "github.com/gin-gonic/gin"
    "installer/internal/server"
    "installer/internal/detector"
    "installer/internal/installer"
)

//go:embed web/dist/*
var webFiles embed.FS

//go:embed assets/*
var assetFiles embed.FS

func main() {
    var (
        port = flag.String("port", "8888", "å®‰è£…ç¨‹åºç«¯å£")
        silent = flag.Bool("silent", false, "é™é»˜å®‰è£…æ¨¡å¼")
    )
    flag.Parse()

    if *silent {
        runSilentInstall()
        return
    }

    // å¯åŠ¨Webå®‰è£…ç•Œé¢
    runWebInstaller(*port)
}

func runWebInstaller(port string) {
    gin.SetMode(gin.ReleaseMode)
    
    // åˆ›å»ºæœåŠ¡å™¨å®ä¾‹
    srv := server.NewServer(webFiles, assetFiles)
    
    // å¯åŠ¨HTTPæœåŠ¡å™¨
    httpServer := &http.Server{
        Addr:    ":" + port,
        Handler: srv.Router(),
    }

    go func() {
        log.Printf("å®‰è£…å‘å¯¼å·²å¯åŠ¨ï¼Œè¯·è®¿é—®: http://localhost:%s", port)
        if err := httpServer.ListenAndServe(); err != nil && err != http.ErrServerClosed {
            log.Fatalf("å¯åŠ¨æœåŠ¡å™¨å¤±è´¥: %v", err)
        }
    }()

    // ä¼˜é›…å…³é—­
    quit := make(chan os.Signal, 1)
    signal.Notify(quit, syscall.SIGINT, syscall.SIGTERM)
    <-quit

    log.Println("æ­£åœ¨å…³é—­å®‰è£…ç¨‹åº...")
    ctx, cancel := context.WithTimeout(context.Background(), 5*time.Second)
    defer cancel()

    if err := httpServer.Shutdown(ctx); err != nil {
        log.Fatal("æœåŠ¡å™¨å¼ºåˆ¶å…³é—­:", err)
    }
    log.Println("å®‰è£…ç¨‹åºå·²é€€å‡º")
}
```

#### 2. HTTPæœåŠ¡å™¨

```go
// internal/server/server.go
package server

import (
    "embed"
    "net/http"
    
    "github.com/gin-gonic/gin"
    "installer/internal/detector"
    "installer/internal/installer"
    "installer/internal/database"
    "installer/internal/deployer"
)

type Server struct {
    webFiles   embed.FS
    assetFiles embed.FS
    detector   detector.Detector
    installer  installer.Manager
    dbManager  database.Manager
    deployer   deployer.Deployer
}

func NewServer(webFiles, assetFiles embed.FS) *Server {
    return &Server{
        webFiles:   webFiles,
        assetFiles: assetFiles,
        detector:   detector.New(),
        installer:  installer.New(),
        dbManager:  database.New(),
        deployer:   deployer.New(assetFiles),
    }
}

func (s *Server) Router() *gin.Engine {
    r := gin.Default()
    
    // é™æ€æ–‡ä»¶æœåŠ¡
    r.StaticFS("/assets", http.FS(s.webFiles))
    
    // APIè·¯ç”±
    api := r.Group("/api")
    {
        api.GET("/system", s.getSystemInfo)
        api.GET("/dependencies", s.checkDependencies)
        api.POST("/install-dependency", s.installDependency)
        api.POST("/test-database", s.testDatabase)
        api.POST("/install", s.startInstallation)
        api.GET("/install-progress", s.getInstallProgress)
    }
    
    // å‰ç«¯è·¯ç”± (SPA)
    r.NoRoute(func(c *gin.Context) {
        c.FileFromFS("web/dist/index.html", http.FS(s.webFiles))
    })
    
    return r
}
```

#### 3. ç³»ç»Ÿæ£€æµ‹å™¨

```go
// internal/detector/system.go
package detector

import (
    "fmt"
    "os"
    "os/exec"
    "runtime"
    "strconv"
    "strings"
)

type SystemInfo struct {
    OS           string `json:"os"`
    Arch         string `json:"arch"`
    Version      string `json:"version"`
    FreeSpace    int64  `json:"free_space"`
    HasAdminPerm bool   `json:"has_admin_perm"`
    NetworkOK    bool   `json:"network_ok"`
}

type DependencyStatus struct {
    Name      string `json:"name"`
    Required  string `json:"required"`
    Current   string `json:"current"`
    Installed bool   `json:"installed"`
    Available bool   `json:"available"`
}

func (d *detector) DetectSystem() (*SystemInfo, error) {
    info := &SystemInfo{
        OS:   runtime.GOOS,
        Arch: runtime.GOARCH,
    }
    
    // æ£€æµ‹æ“ä½œç³»ç»Ÿç‰ˆæœ¬
    switch runtime.GOOS {
    case "windows":
        info.Version = getWindowsVersion()
    case "darwin":
        info.Version = getMacOSVersion()
    case "linux":
        info.Version = getLinuxVersion()
    }
    
    // æ£€æµ‹å¯ç”¨ç£ç›˜ç©ºé—´
    info.FreeSpace = getDiskFreeSpace()
    
    // æ£€æµ‹ç®¡ç†å‘˜æƒé™
    info.HasAdminPerm = hasAdminPermissions()
    
    // æ£€æµ‹ç½‘ç»œè¿æ¥
    info.NetworkOK = testNetworkConnection()
    
    return info, nil
}

func (d *detector) CheckDependencies() ([]DependencyStatus, error) {
    dependencies := []DependencyStatus{
        {Name: "Node.js", Required: ">=18.0.0"},
        {Name: "npm", Required: ">=8.0.0"},
        {Name: "Go", Required: ">=1.21.0"},
        {Name: "Git", Required: ">=2.0.0"},
        {Name: "MySQL", Required: ">=8.0.0"},
        {Name: "MongoDB", Required: ">=6.0.0"},
    }
    
    for i := range dependencies {
        dep := &dependencies[i]
        dep.Current = getVersionCommand(dep.Name)
        dep.Installed = dep.Current != ""
        dep.Available = isPackageAvailable(dep.Name)
    }
    
    return dependencies, nil
}

func getVersionCommand(name string) string {
    var cmd *exec.Cmd
    
    switch strings.ToLower(name) {
    case "node.js":
        cmd = exec.Command("node", "--version")
    case "npm":
        cmd = exec.Command("npm", "--version")
    case "go":
        cmd = exec.Command("go", "version")
    case "git":
        cmd = exec.Command("git", "--version")
    case "mysql":
        cmd = exec.Command("mysql", "--version")
    case "mongodb":
        cmd = exec.Command("mongod", "--version")
    default:
        return ""
    }
    
    output, err := cmd.Output()
    if err != nil {
        return ""
    }
    
    return strings.TrimSpace(string(output))
}
```

#### 4. å®‰è£…ç®¡ç†å™¨

```go
// internal/installer/manager.go
package installer

import (
    "fmt"
    "runtime"
)

type Manager interface {
    Install(pkg string) error
    IsAvailable(pkg string) bool
    GetInstaller() PackageManager
}

type manager struct {
    packageManager PackageManager
}

func New() Manager {
    var pm PackageManager
    
    switch runtime.GOOS {
    case "windows":
        pm = NewWindowsPackageManager()
    case "darwin":
        pm = NewMacOSPackageManager()
    case "linux":
        pm = NewLinuxPackageManager()
    default:
        pm = &DirectDownloadManager{}
    }
    
    return &manager{packageManager: pm}
}

func (m *manager) Install(pkg string) error {
    return m.packageManager.Install(pkg)
}

// WindowsåŒ…ç®¡ç†å™¨
type WindowsPackageManager struct {
    hasChoco bool
    hasScoop bool
}

func NewWindowsPackageManager() *WindowsPackageManager {
    return &WindowsPackageManager{
        hasChoco: commandExists("choco"),
        hasScoop: commandExists("scoop"),
    }
}

func (w *WindowsPackageManager) Install(pkg string) error {
    if w.hasChoco {
        return runCommand("choco", "install", pkg, "-y")
    } else if w.hasScoop {
        return runCommand("scoop", "install", pkg)
    }
    
    // å›é€€åˆ°ç›´æ¥ä¸‹è½½
    return w.directDownload(pkg)
}

func (w *WindowsPackageManager) directDownload(pkg string) error {
    downloadMap := map[string]string{
        "nodejs": "https://nodejs.org/dist/v20.10.0/node-v20.10.0-x64.msi",
        "go":     "https://golang.org/dl/go1.21.5.windows-amd64.msi",
        "git":    "https://github.com/git-for-windows/git/releases/download/v2.43.0.windows.1/Git-2.43.0-64-bit.exe",
    }
    
    url, ok := downloadMap[pkg]
    if !ok {
        return fmt.Errorf("ä¸æ”¯æŒç›´æ¥ä¸‹è½½: %s", pkg)
    }
    
    return downloadAndInstall(url)
}
```

### æ„å»ºå’Œæ‰“åŒ…

#### æ„å»ºè„šæœ¬

```bash
#!/bin/bash
# scripts/build.sh

echo "ğŸ—ï¸  æ„å»ºå®‰è£…å‘å¯¼ç¨‹åº..."

# æ„å»ºå‰ç«¯
echo "ğŸ“¦ æ„å»ºå‰ç«¯ç•Œé¢..."
cd web
npm install
npm run build
cd ..

# æ„å»ºGoç¨‹åº
echo "ğŸ”¨ æ„å»ºGoç¨‹åº..."
CGO_ENABLED=0 go build -ldflags="-s -w" -o dist/installer cmd/installer/main.go

# ä¸ºä¸åŒå¹³å°æ„å»º
echo "ğŸŒ æ„å»ºè·¨å¹³å°ç‰ˆæœ¬..."
GOOS=windows GOARCH=amd64 go build -ldflags="-s -w" -o dist/installer-windows-amd64.exe cmd/installer/main.go
GOOS=darwin GOARCH=amd64 go build -ldflags="-s -w" -o dist/installer-macos-amd64 cmd/installer/main.go
GOOS=darwin GOARCH=arm64 go build -ldflags="-s -w" -o dist/installer-macos-arm64 cmd/installer/main.go
GOOS=linux GOARCH=amd64 go build -ldflags="-s -w" -o dist/installer-linux-amd64 cmd/installer/main.go

echo "âœ… æ„å»ºå®Œæˆï¼"
```

#### æ‰“åŒ…è„šæœ¬

```bash
#!/bin/bash
# scripts/package.sh

VERSION=${1:-"1.0.0"}
echo "ğŸ“¦ æ‰“åŒ…å®‰è£…ç¨‹åº v$VERSION..."

# åˆ›å»ºå‘å¸ƒç›®å½•
mkdir -p releases/v$VERSION

# æ‰“åŒ…Windowsç‰ˆæœ¬
zip -r releases/v$VERSION/installer-windows-amd64.zip dist/installer-windows-amd64.exe README.md LICENSE
echo "âœ… Windowsç‰ˆæœ¬æ‰“åŒ…å®Œæˆ"

# æ‰“åŒ…macOSç‰ˆæœ¬
tar -czf releases/v$VERSION/installer-macos-amd64.tar.gz dist/installer-macos-amd64 README.md LICENSE
tar -czf releases/v$VERSION/installer-macos-arm64.tar.gz dist/installer-macos-arm64 README.md LICENSE
echo "âœ… macOSç‰ˆæœ¬æ‰“åŒ…å®Œæˆ"

# æ‰“åŒ…Linuxç‰ˆæœ¬
tar -czf releases/v$VERSION/installer-linux-amd64.tar.gz dist/installer-linux-amd64 README.md LICENSE
echo "âœ… Linuxç‰ˆæœ¬æ‰“åŒ…å®Œæˆ"

echo "ğŸ‰ æ‰€æœ‰ç‰ˆæœ¬æ‰“åŒ…å®Œæˆï¼"
ls -la releases/v$VERSION/
```

---

## ğŸš€ éƒ¨ç½²ç­–ç•¥

### å‘å¸ƒæ¸ é“

#### 1. GitHub Releases
```yaml
# .github/workflows/release.yml
name: Release Installer

on:
  push:
    tags:
      - 'v*'

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    
    - name: Setup Go
      uses: actions/setup-go@v3
      with:
        go-version: '1.21'
    
    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'
    
    - name: Build
      run: ./scripts/build.sh
    
    - name: Package
      run: ./scripts/package.sh ${{ github.ref_name }}
    
    - name: Create Release
      uses: softprops/action-gh-release@v1
      with:
        files: releases/${{ github.ref_name }}/*
```

#### 2. å®˜ç½‘ä¸‹è½½
```html
<!-- ä¸‹è½½é¡µé¢ -->
<div class="download-section">
  <h2>ä¸‹è½½å®‰è£…ç¨‹åº</h2>
  
  <div class="platform-downloads">
    <div class="platform">
      <h3>Windows</h3>
      <a href="/releases/latest/installer-windows-amd64.zip" 
         class="download-btn">
        ä¸‹è½½ Windows ç‰ˆæœ¬
      </a>
    </div>
    
    <div class="platform">
      <h3>macOS</h3>
      <a href="/releases/latest/installer-macos-amd64.tar.gz" 
         class="download-btn">
        ä¸‹è½½ Intel Mac ç‰ˆæœ¬
      </a>
      <a href="/releases/latest/installer-macos-arm64.tar.gz" 
         class="download-btn">
        ä¸‹è½½ Apple Silicon ç‰ˆæœ¬
      </a>
    </div>
    
    <div class="platform">
      <h3>Linux</h3>
      <a href="/releases/latest/installer-linux-amd64.tar.gz" 
         class="download-btn">
        ä¸‹è½½ Linux ç‰ˆæœ¬
      </a>
    </div>
  </div>
</div>
```

### ä½¿ç”¨è¯´æ˜

#### Windowsç”¨æˆ·
```bash
# 1. ä¸‹è½½å®‰è£…ç¨‹åº
curl -LO https://github.com/your-org/plugin-system/releases/latest/download/installer-windows-amd64.zip

# 2. è§£å‹å¹¶è¿è¡Œ
unzip installer-windows-amd64.zip
./installer-windows-amd64.exe
```

#### macOSç”¨æˆ·
```bash
# 1. ä¸‹è½½å®‰è£…ç¨‹åº
curl -LO https://github.com/your-org/plugin-system/releases/latest/download/installer-macos-amd64.tar.gz

# 2. è§£å‹å¹¶è¿è¡Œ
tar -xzf installer-macos-amd64.tar.gz
chmod +x installer-macos-amd64
./installer-macos-amd64
```

#### Linuxç”¨æˆ·
```bash
# 1. ä¸‹è½½å®‰è£…ç¨‹åº
wget https://github.com/your-org/plugin-system/releases/latest/download/installer-linux-amd64.tar.gz

# 2. è§£å‹å¹¶è¿è¡Œ
tar -xzf installer-linux-amd64.tar.gz
chmod +x installer-linux-amd64
./installer-linux-amd64
```

---

## ğŸ”® é«˜çº§ç‰¹æ€§

### 1. ç¦»çº¿å®‰è£…æ”¯æŒ

```go
// åµŒå…¥ç¦»çº¿å®‰è£…åŒ…
//go:embed offline-packages/*
var offlinePackages embed.FS

func (m *manager) InstallOffline(pkg string) error {
    packageFile, err := offlinePackages.Open(fmt.Sprintf("offline-packages/%s-%s-%s", pkg, runtime.GOOS, runtime.GOARCH))
    if err != nil {
        return m.Install(pkg) // å›é€€åˆ°åœ¨çº¿å®‰è£…
    }
    defer packageFile.Close()
    
    return m.installFromFile(packageFile)
}
```

### 2. é…ç½®é¢„è®¾

```json
{
  "presets": {
    "development": {
      "database": {
        "mysql": {
          "host": "localhost",
          "port": 3306,
          "username": "developer",
          "password": "dev123456"
        }
      },
      "services": {
        "debug_mode": true,
        "log_level": "debug"
      }
    },
    "production": {
      "database": {
        "mysql": {
          "host": "prod-db.example.com",
          "port": 3306,
          "ssl": true
        }
      },
      "services": {
        "debug_mode": false,
        "log_level": "info"
      }
    }
  }
}
```

### 3. å®‰è£…åéªŒè¯

```go
func (d *deployer) VerifyInstallation() error {
    checks := []func() error{
        d.checkServiceHealth,
        d.checkDatabaseConnection,
        d.checkPluginSystem,
        d.checkWebInterface,
    }
    
    for _, check := range checks {
        if err := check(); err != nil {
            return err
        }
    }
    
    return nil
}

func (d *deployer) checkServiceHealth() error {
    resp, err := http.Get("http://localhost:8080/health")
    if err != nil {
        return err
    }
    defer resp.Body.Close()
    
    if resp.StatusCode != 200 {
        return fmt.Errorf("æœåŠ¡å¥åº·æ£€æŸ¥å¤±è´¥ï¼ŒçŠ¶æ€ç : %d", resp.StatusCode)
    }
    
    return nil
}
```

### 4. è‡ªåŠ¨æ›´æ–°æœºåˆ¶

```go
type UpdateChecker struct {
    currentVersion string
    updateURL      string
}

func (u *UpdateChecker) CheckForUpdates() (*UpdateInfo, error) {
    resp, err := http.Get(u.updateURL + "/latest")
    if err != nil {
        return nil, err
    }
    defer resp.Body.Close()
    
    var updateInfo UpdateInfo
    if err := json.NewDecoder(resp.Body).Decode(&updateInfo); err != nil {
        return nil, err
    }
    
    if version.Compare(updateInfo.Version, u.currentVersion) > 0 {
        return &updateInfo, nil
    }
    
    return nil, nil // æ— éœ€æ›´æ–°
}
```

---

**æ–¹æ¡ˆæ€»ç»“**: è¿™ä¸ªè®¾è®¡æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„è·¨å¹³å°Webå®‰è£…å‘å¯¼è§£å†³æ–¹æ¡ˆï¼Œå…·æœ‰è‡ªåŠ¨ä¾èµ–æ£€æµ‹ã€æ™ºèƒ½å®‰è£…ã€å‹å¥½ç•Œé¢ç­‰ç‰¹æ€§ã€‚ç”¨æˆ·åªéœ€ä¸‹è½½å¯¹åº”å¹³å°çš„å®‰è£…ç¨‹åºï¼Œå³å¯é€šè¿‡Webç•Œé¢å®Œæˆæ•´ä¸ªç³»ç»Ÿçš„å®‰è£…é…ç½®ã€‚

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0  
**æœ€åæ›´æ–°**: 2025-06-20  
**ç»´æŠ¤å›¢é˜Ÿ**: æ’ä»¶ç³»ç»Ÿå¼€å‘å›¢é˜Ÿ 